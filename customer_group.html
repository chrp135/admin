<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/js/layui/css/layui.css">
    <link rel="stylesheet" href="static/css/admin.css">
    <title>旅业盒子</title>
</head>

<body>
    <div class="header-con flex-box">
        <div class="logo">
            <img src="static/img/logo.png">
        </div>
        <div class="lxs layui-nav">
            <div class="lxs-name"><i class="iconfont icon-qiye"></i>厦门宝中旅行社</div>
            <div class="layui-nav-item c-blue">
                <a href="javascript:;" class="">切换</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
        <div class="login-status layui-nav">
            <div class="layui-nav-item">
                <a href="javascript:;">欢迎您，陈明明</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
    </div>
    <div class="left-con">
        <div class="scroll-con">
                <dl>
                    <dt>
                        <a href="javascript:;">
                            <i class="iconfont icon-shouye"></i>
                            <cite>首页</cite>
                        </a>
                    </dt>
                </dl>
                <dl class="open">
                    <dt href="javascript:;">
                        <i class="iconfont icon-renwuguanli"></i>
                        <cite>任务管理</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="" class="on">任务管理</a>
                        <a href="">申请开票</a>
                        <a href="">开票记录</a>
                        <a href="">完税凭证</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-lingkeguanli"></i>
                        <cite>零客管理</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">采购订单</a>
                        <a href="">分销订单</a>
                        <a href="">保险订单</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-fuwushang"></i>
                        <cite>服务商</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">邀请分销商</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-caiwu1"></i>
                        <cite>财务</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">资金管理</a>
                        <a href="">提现申请</a>
                        <a href="">发票管理</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-shezhi"></i>
                        <cite>设置</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">常用信息</a>
                        <a href="">账号信息</a>
                        <a href="">修改密码</a>
                    </dd>
                </dl>
        </div>
        <a href="javascript:;" class="btn-side J-btn-side"><i class="iconfont icon-left"></i></a>
    </div>
    <div class="body-con layui-form">
        <div class="body-wrap">
            <div class="ndwz">
                首页 > <a href="">任务管理</a>
            </div>
            <div class="ui-tag-tit">
                <ul>
                    <li><a href="javascript:;" class="on">发布任务</a></li>
                </ul>
            </div>
            <div class="layui-card pd-20">
                <div class="layui-card-body mg-t-10">
                    <div class="layui-row layui-col-space30">
                        <div class="layui-col-xs4">
                            <div class="ui-tit">
                                <b>分组管理</b>
                                <div class="fr">
                                    <a href="javascript:;" class="layui-btn btn-sm plain J-group-edit" data-type="add">添加分组</a>
                                </div>
                            </div>
                            <table class="layui-table mg-t-10" lay-filter="table-list">
                                <tbody>
                                    <tr>
                                        <td>市场推（2）</td>
                                        <td class="text-r">
                                            <a href="JavaScript:;" class="J-group-edit" data-id="1">编辑</a>
                                            <a href="JavaScript:;" class="J-btn-del">删除</a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>市场推广项目组（2）</td>
                                        <td class="text-r">
                                            <a href="JavaScript:;" class="J-group-edit" data-id="2">编辑</a>
                                            <a href="JavaScript:;" class="J-btn-del">删除</a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="layui-col-xs8 bg-f9fbff">
                            <div class="ui-tit">
                                <b>零客所在组</b>
                                <div class="fr">
                                    <a href="javascript:;" class="layui-btn btn-sm plain btn-grey J-del-group">删除</a>
                                    <a href="javascript:;" class="layui-btn btn-sm plain btn-grey J-adjust-group">调整分组</a>
                                    <a href="javascript:;" class="layui-btn btn-sm plain J-add-customer">添加零客</a>
                                </div>
                            </div>
                            <table class="layui-table mg-t-10" lay-filter="table-list">
                                <thead>
                                    <tr>
                                        <th width="50">
                                            <input type="checkbox" name="checkboxAll2" class="J-check-all" lay-filter="checkboxAll2" lay-skin="primary" title="全选">
                                        </th>
                                        <th width="100">姓名</th>
                                        <th width="120">手机号</th>
                                        <th width="">证件号</th>
                                        <th width="120">任务佣金</th>
                                        <th width="150" class="text-r">预计收入</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title=""></td>
                                        <td>陈敏敏</td>
                                        <td>15966055220</td>
                                        <td>35021219901206056</td>
                                        <td><input type="text" name="keyword" value="" placeholder="请输入" autocomplete="off" class="layui-input ui-w200"></td>
                                        <td class="text-r">0.00</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="2"  lay-skin="primary" title=""></td>
                                        <td>陈敏敏</td>
                                        <td>15966055220</td>
                                        <td>35021219901206056</td>
                                        <td><input type="text" name="keyword" value="" placeholder="请输入" autocomplete="off" class="layui-input ui-w200"></td>
                                        <td class="text-r">0.00</td>
                                    </tr>
                                    <tr>
                                        <td><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="3"  lay-skin="primary" title=""></td>
                                        <td>陈敏敏</td>
                                        <td>15966055220</td>
                                        <td>35021219901206056</td>
                                        <td><input type="text" name="keyword" value="" placeholder="请输入" autocomplete="off" class="layui-input ui-w200"></td>
                                        <td class="text-r">0.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="layui-clear">
            </div>
            
            <!-- <div class="footer-btn">
                <a href="" class="layui-btn btn-lg plain">取消</a>
                <a href="" class="layui-btn btn-lg btn-normal">确认完成</a>
            </div> -->
        </div>
        <!-- <div class="footer-con">
            &copy; Copyright 2020 多多优采&emsp;|&emsp;技术支持：<a>厦门市旅动力信息有限公司</a>
        </div> -->
    </div>

<script type="text/html" id="tpl-group">
    <div class="layui-form">
        <div class="layui-form-item pd-20">
            <label class="layui-form-label">分组名称：</label>
            <div class="layui-input-block">
                <input type="text" name="keyword" value="{{#name}}" placeholder="" autocomplete="off" class="layui-input">
            </div>
        </div>
    </div>
</script>

<script type="text/html" id="tpl-adjust-group">
    <div class="layui-form">
        <table class="layui-table" lay-filter="table-list">
            <tbody>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="市场推广项目组（2）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="心理健康咨询项目组（14）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="企业管理咨询项目组（0）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="营销服务项目组（12）"></td>
                </tr>
            </tbody>
        </table>
    </div>
</script>

<script type="text/html" id="tpl-add-customer">
    <div class="layui-form">
        <table class="layui-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>昵称</th>
                    <th>姓名</th>
                    <th>手机号</th>
                    <th>证件号</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="1"></td>
                    <td>Zoom时代小陈</td>
                    <td>陈敏敏</td>
                    <td>13666666666</td>
                    <td>35021219901206056</td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="1"></td>
                    <td>Zoom时代小陈</td>
                    <td>陈敏敏</td>
                    <td>13666666666</td>
                    <td>35021219901206056</td>
                </tr>
                <tr>
                    <td width="50"><input type="checkbox" name="check2" class="J-check-item" lay-filter="check2" value="1" lay-skin="primary" title="1"></td>
                    <td>Zoom时代小陈</td>
                    <td>陈敏敏</td>
                    <td>13666666666</td>
                    <td>35021219901206056</td>
                </tr>
            </tbody>
        </table>
    </div>
</script>
<script src="static/js/layui/layui.js"></script>
<script src="static/js/layui/config.js"></script>
<!-- <script src="static/js/qrcode.min.js"></script> -->

<script>
    layui.use(['laydate', 'layer', 'table', 'form', 'upload', 'element', 'laytpl', 'tableNav'], function () {
        var $ = layui.jquery
            , laydate = layui.laydate //日期
            , layer = layui.layer //弹层
            , table = layui.table // 表格
            , form = layui.form //表单
            , upload = layui.upload
            , element = layui.element //元素操作
            , laytpl = layui.laytpl
            // , tableNav = layui.tableNav


        //全选
        form.on('checkbox(checkboxAll2)', function (data) {
            var table = $(data.elem).parents('.layui-table'),
            childs = table.find('.J-check-item');
            data.elem.checked ? childs.prop('checked', true) : childs.prop('checked', false);
            table.find('tr').addClass('on')
            form.render();
        });

        form.on('checkbox(check2)', function (data) {
            var table = $(data.elem).parents('.layui-table'),
                checkall = table.find('.J-check-all'),
                check_item = table.find('.J-check-item'),
                item_len = check_item.length,
                check_len = table.find('.J-check-item:checked').length;
                
            // console.log(item_len, check_len)
            item_len == check_len ? checkall.prop('checked', true) : checkall.prop('checked', false);
            form.render();
        });

        $('body').on('click','.J-group-edit',function(){
            var self = $(this),
                type = self.attr('data-type'),
                id = self.attr('data-id')
            var html = $('#tpl-group').html()
            if(type == 'add'){
                var tbody = self.parents('.ui-tit').siblings('table').find('tbody'),
                html = html.replace('{{#name}}','')
            }else{
                var tr = self.parents('tr'),
                    text = tr.find('td').eq(0).text(),
                    html = html.replace('{{#name}}',text)
            }
            // 弹出页面层
            layer.open({
                type: 1
                , title: '发布任务成功'
                , area: ['560px', '350px']
                , shade: .3
                , btn: ['确定','取消']
                , btnAlign: 'c'
                , content: html
                // , btn: ["提交", '关闭'] //只是为了演示
                , success: function(){
                }
                , yes: function (index, layero) {
                    var input = layero.find('input[name="keyword"]'),
                        val = input.val()
                    $('body').on('blur','input[name="keyword"]',function(){
                        if($(this).val() != ''){
                            $(this).removeClass('layui-form-danger')
                        }
                    })
                    if(type == 'add'){
                        if(val == ''){
                            layer.msg('分组名称不能为空')
                            input.focus().addClass('layui-form-danger')
                            return false
                        }
                        var _html = `<tr>
                                <td>`+val+`</td>
                                <td class="text-r">
                                        <a href="JavaScript:;" class="J-group-edit">编辑</a>
                                        <a href="JavaScript:;" class="J-btn-del">删除</a>
                                        </td>
                                        </tr>`
                        tbody.append(_html)
                        console.log(val,_html);
                    }else{
                        tr.find('td').eq(0).text(val)
                    }
                    layer.closeAll()
                }
            });
        })
        // 分组管理删除
        $('body').on('click','.J-btn-del',function(){
            var self = $(this)
            self.parents('tr').remove()
        })


        $('body').on('click','.J-adjust-group',function(){
            // 弹出页面层
            var html = $('#tpl-adjust-group').html()
            layer.open({
                type: 1
                , title: '发布任务成功'
                , area: ['560px', '350px']
                , shade: .3
                , btn: ['确定','取消']
                , btnAlign: 'c'
                , content: html
                // , btn: ["提交", '关闭'] //只是为了演示
                , success: function(){
                    form.render()
                }
                , yes: function (index, layero) {
                }
            });

        })
        $('body').on('click','.J-add-customer',function(){
            // 弹出页面层
            var html = $('#tpl-add-customer').html()
            layer.open({
                type: 1
                , title: '发布任务成功'
                , area: ['560px', '350px']
                , shade: .3
                , btn: ['确定','取消']
                , btnAlign: 'c'
                , content: html
                // , btn: ["提交", '关闭'] //只是为了演示
                , success: function(){
                    form.render()
                }
                , yes: function (index, layero) {
                }
            });

        })
    })
    
</script>
</body>
</html>