<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/js/layui/css/layui.css">
    <link rel="stylesheet" href="static/css/admin.css">
    <title>旅业盒子</title>
</head>

<body>
    <div class="header-con flex-box">
        <div class="logo">
            <img src="static/img/logo.png">
        </div>
        <div class="lxs layui-nav">
            <div class="lxs-name"><i class="iconfont icon-qiye"></i>厦门宝中旅行社</div>
            <div class="layui-nav-item c-blue">
                <a href="javascript:;" class="">切换</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
        <div class="login-status layui-nav">
            <div class="layui-nav-item">
                <a href="javascript:;">欢迎您，陈明明</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
    </div>
    <div class="left-con">
        <div class="scroll-con">
            <dl>
                <dt>
                    <a href="javascript:;">
                        <i class="iconfont icon-shouye"></i>
                        <cite>首页</cite>
                    </a>
                </dt>
            </dl>
            <dl class="open">
                <dt href="javascript:;">
                    <i class="iconfont icon-renwuguanli"></i>
                    <cite>任务管理</cite>
                    <i class="iconfont icon-angle-down"></i>
                </dt>
                <dd>
                    <a href="" class="on">任务管理</a>
                    <a href="">申请开票</a>
                    <a href="">开票记录</a>
                    <a href="">完税凭证</a>
                </dd>
            </dl>
            <dl>
                <dt href="javascript:;">
                    <i class="iconfont icon-lingkeguanli"></i>
                    <cite>零客管理</cite>
                    <i class="iconfont icon-angle-down"></i>
                </dt>
                <dd>
                    <a href="">采购订单</a>
                    <a href="">分销订单</a>
                    <a href="">保险订单</a>
                </dd>
            </dl>
            <dl>
                <dt href="javascript:;">
                    <i class="iconfont icon-fuwushang"></i>
                    <cite>服务商</cite>
                    <i class="iconfont icon-angle-down"></i>
                </dt>
                <dd>
                    <a href="">邀请分销商</a>
                </dd>
            </dl>
            <dl>
                <dt href="javascript:;">
                    <i class="iconfont icon-caiwu1"></i>
                    <cite>财务</cite>
                    <i class="iconfont icon-angle-down"></i>
                </dt>
                <dd>
                    <a href="">资金管理</a>
                    <a href="">提现申请</a>
                    <a href="">发票管理</a>
                </dd>
            </dl>
            <dl>
                <dt href="javascript:;">
                    <i class="iconfont icon-shezhi"></i>
                    <cite>设置</cite>
                    <i class="iconfont icon-angle-down"></i>
                </dt>
                <dd>
                    <a href="">常用信息</a>
                    <a href="">账号信息</a>
                    <a href="">修改密码</a>
                </dd>
            </dl>
        </div>
        <a href="javascript:;" class="btn-side J-btn-side"><i class="iconfont icon-left"></i></a>
    </div>
    <div class="body-con">
        <div class="body-wrap">
            <div class="ndwz">
                <a href="">首页</a> > <a href="">任务管理</a> > <span>任务详情</span>
            </div>
            <div class="layui-card pd-20 layui-form">
                <div class="ui-tit">
                    <b>发票信息</b>
                </div>
                <div class="layui-card-body mg-t-20">
                    <div class="billing-con vh80">
                        <table class="billing">
                            <thead>
                                <tr>
                                    <td colspan="9">
                                        <div class="flex-box">
                                            <div class="flex-item">
                                                <span>货物或应税劳务、服务名称</span>&emsp;&emsp;
                                                <span>平安银行重庆南岸支行11087748848484</span>
                                            </div>
                                            <a href="javascript:;" class="layui-btn plain btn-sm J-del">删除</a>
                                        </div>
                                    </td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th>
                                        货物或应税劳务、服务名称<br>
                                        <span>*现代服务*其他现代服务</span>
                                    </th>
                                    <th>规格型号<br></th>
                                    <th>单位<br></th>
                                    <th>数量<br></th>
                                    <th>单价<br></th>
                                    <th>金额<br><span class="price">0.00</span></th>
                                    <th>税率<br><span class="rate" data-rate="6">6%</span></th>
                                    <th>税额<br><span class="amount">0</span></th>
                                    <th>含税金额<br>
                                        <div class="layui-input-inline">
                                            <input type="text" name="keyword" value="0" placeholder="" autocomplete="off" class="layui-input ui-w100 text-c J-tax-price">
                                        </div>
                                    </th>
                                </tr>
                                <tr>
                                    <td>价税合计（大写）</td>
                                    <td colspan="8">
                                        <div class="flex-box">
                                            <div class="case1 flex-item"><span class="num1">零</span>元整</div>
                                            <div class="case2 flex-item"><em>（小写）</em>&emsp;<span class="num2">0.00</span></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="text-c">备注</td>
                                    <td colspan="8">
                                        <textarea name="" id="" class="layui-textarea"></textarea>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="add-billing J-add-billing"><i class="iconfont icon-tianjiajiahao"></i>&ensp;增加发票</div>
                        <textarea name="" id="" class="layui-textarea" placeholder="填写开票说明"></textarea>
                    </div>
                </div>
                <div class="sticky-bottom mg-t-20">
                    <div class="layui-input-inline mg-r-20 c-999">
                        可申请开票金额：<span class="c-333">￥20.00</span>&emsp;&emsp;
                        发票总价税合计：<span class="c-orange">￥20.00</span>&emsp;&emsp;
                        未开票金额：<span class="c-orange">￥0.00</span>
                    </div>
                    <a href="javascript:;" class="layui-btn btn-lg plain">返回</a>
                    <a href="javascript:;" class="layui-btn btn-lg btn-normal J-btn-sure">保存</a>
                </div>
            </div>
        </div>
    </div>

<script type="text/html" id="tpl-billing">
    <table class="billing">
        <thead>
            <tr>
                <td colspan="9">
                    <div class="flex-box">
                        <div class="flex-item">
                            <span>货物或应税劳务、服务名称</span>&emsp;&emsp;
                            <span>平安银行重庆南岸支行11087748848484</span>
                        </div>
                        <a href="javascript:;" class="layui-btn plain btn-sm J-del">删除</a>
                    </div>
                </td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th>
                    货物或应税劳务、服务名称<br>
                    <span>*现代服务*其他现代服务</span>
                </th>
                <th>规格型号<br></th>
                <th>单位<br></th>
                <th>数量<br></th>
                <th>单价<br></th>
                <th>金额<br><span class="price">0.00</span></th>
                <th>税率<br><span class="rate" data-rate="6">6%</span></th>
                <th>税额<br><span class="amount">0</span></th>
                <th>含税金额<br>
                    <div class="layui-input-inline">
                        <input type="text" name="keyword" value="0" placeholder="" autocomplete="off" class="layui-input ui-w100 text-c J-tax-price">
                    </div>
                </th>
            </tr>
            <tr>
                <td>价税合计（大写）</td>
                <td colspan="8">
                    <div class="flex-box">
                        <div class="case1 flex-item"><span class="num1">零</span>元整</div>
                        <div class="case2 flex-item"><em>（小写）</em>&emsp;<span class="num2">0.00</span></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="text-c">备注</td>
                <td colspan="8">
                    <textarea name="" id="" class="layui-textarea"></textarea>
                </td>
            </tr>
        </tbody>
    </table>
</script>
    <script src="static/js/layui/layui.js"></script>
    <script src="static/js/layui/config.js"></script>
    <!-- <script src="static/js/qrcode.min.js"></script> -->

    <script>
        layui.use(['laydate', 'layer', 'table', 'form', 'upload', 'element', 'laytpl'], function () {
            var $ = layui.jquery
                , laydate = layui.laydate //日期
                , layer = layui.layer //弹层
                , table = layui.table // 表格
                , form = layui.form //表单
                , upload = layui.upload
                , element = layui.element //元素操作
                , laytpl = layui.laytpl

            function NoToChinese(num) {
                if (!/^\d*(\.\d*)?$/.test(num)) {
                    alert("Number is wrong!");
                    return "Number is wrong!";
                }
                var AA = new Array("零", "一", "二", "三", "四", "五", "六", "七", "八", "九");
                var BB = new Array("", "十", "百", "千", "万", "亿", "点", "");
                var a = ("" + num).replace(/(^0*)/g, "").split("."),
                    k = 0,
                    re = "";
                for (var i = a[0].length - 1; i >= 0; i--) {
                    switch (k) {
                        case 0:
                            re = BB[7] + re;
                            break;
                        case 4:
                            if (!new RegExp("0{4}\\d{" + (a[0].length - i - 1) + "}$").test(a[0]))
                                re = BB[4] + re;
                            break;
                        case 8:
                            re = BB[5] + re;
                            BB[7] = BB[5];
                            k = 0;
                            break;
                    }
                    if (k % 4 == 2 && a[0].charAt(i + 2) != 0 && a[0].charAt(i + 1) == 0) re = AA[0] + re;
                    if (a[0].charAt(i) != 0) re = AA[a[0].charAt(i)] + BB[k % 4] + re;
                    k++;
                }
                if (a.length > 1) //加上小数部分(如果有小数部分) 
                {
                    re += BB[6];
                    for (var i = 0; i < a[1].length; i++) re += AA[a[1].charAt(i)];
                }
                return re;
            };

            $('body').on('click','.add-billing',function(){
                var html = $('#tpl-billing').html()
                $(this).before(html)
            })

            $('body').on('blur','.J-tax-price',function(){
                var self = $(this),
                    tr = self.parents('tr'),
                    rate = tr.find('.rate').attr('data-rate'),
                    amount = tr.find('.amount'),
                    price = tr.find('.price'),
                    value = self.val(),
                    num1 = tr.next('tr').find('.num1'),
                    num2 = tr.next('tr').find('.num2')
                num1.text(NoToChinese(value))
                num2.text(Number(value).toFixed(2))
                price.text((value/(1+rate/100)).toFixed(2))
                amount.text((value-value/(1+rate/100)).toFixed(2))

            })

            $('body').on('click','.J-del',function(){
                var self = $(this),
                    table = self.parents('table')
                table.remove()
                
            })

        })

    </script>
</body>

</html>