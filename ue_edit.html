<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/js/layui/css/layui.css">
    <link rel="stylesheet" href="static/css/admin.css">
    <title>旅业盒子</title>
</head>

<body>
    <div class="header-con flex-box">
        <div class="logo">
            <img src="static/img/logo.png">
        </div>
        <div class="lxs layui-nav">
            <div class="lxs-name"><i class="iconfont icon-qiye"></i>厦门宝中旅行社</div>
            <div class="layui-nav-item c-blue">
                <a href="javascript:;" class="">切换</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
        <div class="login-status layui-nav">
            <div class="layui-nav-item">
                <a href="javascript:;">欢迎您，陈明明</a>
                <dl class="layui-nav-child">
                    <dd><a href="">选项1</a></dd>
                    <dd><a href="">选项2</a></dd>
                    <dd><a href="">选项3</a></dd>
                </dl>
            </div>
        </div>
    </div>
    <div class="left-con">
        <div class="scroll-con">
                <dl>
                    <dt>
                        <a href="javascript:;">
                            <i class="iconfont icon-shouye"></i>
                            <cite>首页</cite>
                        </a>
                    </dt>
                </dl>
                <dl class="open">
                    <dt href="javascript:;">
                        <i class="iconfont icon-renwuguanli"></i>
                        <cite>任务管理</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="" class="on">任务管理</a>
                        <a href="">申请开票</a>
                        <a href="">开票记录</a>
                        <a href="">完税凭证</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-lingkeguanli"></i>
                        <cite>零客管理</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">采购订单</a>
                        <a href="">分销订单</a>
                        <a href="">保险订单</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-fuwushang"></i>
                        <cite>服务商</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">邀请分销商</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-caiwu1"></i>
                        <cite>财务</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">资金管理</a>
                        <a href="">提现申请</a>
                        <a href="">发票管理</a>
                    </dd>
                </dl>
                <dl>
                    <dt href="javascript:;">
                        <i class="iconfont icon-shezhi"></i>
                        <cite>设置</cite>
                        <i class="iconfont icon-angle-down"></i>
                    </dt>
                    <dd>
                        <a href="">常用信息</a>
                        <a href="">账号信息</a>
                        <a href="">修改密码</a>
                    </dd>
                </dl>
        </div>
        <a href="javascript:;" class="btn-side J-btn-side"><i class="iconfont icon-left"></i></a>
    </div>
    <div class="body-con">
        <div class="body-wrap">
            <div class="ndwz">
                <a href="">首页</a> > <a href="">任务管理</a> > <span>任务详情</span>
            </div>
            <div class="ui-tag-tit">
                <ul>
                    <li><a href="javascript:;" class="on">用工企业详情</a></li>
                </ul>
            </div>
            <form class="layui-form" action="" method="post">
                <div class="layui-card pd-20">
                    <div class="ui-tit">
                        <b>任务信息</b>
                    </div>
                    <div class="layui-card-body mg-t-10">
                        <script id="container" name="content" type="text/plain">这里写你的初始化内容</script>
                        <div class="layui-btn J-submit-edit">提交</div>
                    </div>
                </div>
            </form>
        </div>
        <div class="footer-con">
            &copy; Copyright 2020 多多优采&emsp;|&emsp;技术支持：<a>厦门市旅动力信息有限公司</a>
        </div>
    </div>

<script type="text/html" id="tpl-mobile-qrcode">
    <div class="qrcode text-c" data-url="{{#qrcode_url}}">
        <p>手机扫码预订产品：</p>
        <div id="qrcode_order" class="text-c sub-img-auto mg-t-10"></div>
    </div>
</script>
<script src="static/js/layui/layui.js"></script>
<script src="static/js/layui/config.js"></script>
<!-- <script src="static/js/qrcode.min.js"></script> -->
<script src="static/js/layui/area_json.js"></script>
<script src="static/js/ueditor/ueditor.config.js"></script>
<script src="static/js/ueditor/ueditor.all.min.js"></script>
<script src="static/js/ueditor/lang/zh-cn/zh-cn.js" defer="defer"></script>
<script>
    layui.use(['laydate', 'layer', 'table', 'form', 'upload', 'element', 'laytpl', 'layuiarea'], function () {
        var $ = layui.jquery
            , laydate = layui.laydate //日期
            , layer = layui.layer //弹层
            , table = layui.table // 表格
            , form = layui.form //表单
            , upload = layui.upload
            , element = layui.element //元素操作
            , laytpl = layui.laytpl
            ,layedit = layui.layedit
            , common = layui.common

        // 获取select选中值 select添加属性lay-filter="xxx"
        form.on('select(test)', function(data){
            console.log(data.value);
        })

        
        // var ue = UE.getEditor('container');
        var ue = UE.getEditor('container', {
            // toolbars: [
            //     ['fullscreen', 'source', 'undo', 'redo', 'bold']
            // ],
            initialFrameHeight: 300,
            // initialFrameWidth: 400
            // autoHeightEnabled: true,
            // autoFloatEnabled: true
        });
        //对编辑器的操作最好在编辑器ready之后再做
        ue.ready(function(){
            //设置编辑器的内容
            ue.setContent('hello');
            //获取html内容，返回: <p>hello</p>
            var html = ue.getContent();
            //获取纯文本内容，返回: hello
            var txt = ue.getContentTxt();
        });
        $('body').on('click','.J-submit-edit',function(){
            var html = ue.getContent();
            var txt = ue.getContentTxt();
            console.log(html,txt);
        })

        // 正则验证
        form.verify({
            username: function(value, item){ //value：表单的值、item：表单的DOM对象
                if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)){
                    return '保单联系人不能有特殊字符';
                }
                if(/(^\_)|(\__)|(\_+$)/.test(value)){
                    return '保单联系人首尾不能出现下划线\'_\'';
                }
                if(/^\d+\d+\d$/.test(value)){
                    return '保单联系人不能全为数字';
                }
                //如果不想自动弹出默认提示框，可以直接返回 true，这时你可以通过其他任意方式提示（v2.5.7 新增）
                if(value === 'xxx'){
                    alert('保单联系人不能为敏感词');
                    return true;
                }
            }
            , mobile: [/^1[2-9]\d{9}$/,'手机号码错误']
            , email: [/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,'邮箱格式错误']

        });
        
        // 城市联动
        layuiarea = layui.layuiarea();

        //日期范围
        laydate.render({
            elem: '#start_date'
            ,range: true
        });


        //普通图片上传
        // var uploadInst = upload.render({
        //     elem: '#test1'
        //     // ,url: 'https://httpbin.org/post' //改成您自己的上传接口
        //     , before: function (obj) {
        //         //预读本地文件示例，不支持ie8
        //         obj.preview(function (index, file, result) {
        //         $('#demo1').attr('src', result); //图片链接（base64）
        //         });
        //     }
        // });

        // 上传多图
        upload.render({
            elem: '#test1'
            ,url: '/api/upload/'
            ,auto: false //选择文件后不自动上传
            ,multiple: true
            ,bindAction: '#testListAction' //指向一个按钮触发上传
            ,choose: function(obj){
                //将每次选择的文件追加到文件队列
                var files = obj.pushFile();
                //预读本地文件，如果是多文件，则会遍历。(不支持ie8/9)
                obj.preview(function(index, file, result){
                    $('#upload-list').append('<li><i class="iconfont icon-guanbi2fill"></i><img src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img"></li>')
                    // console.log(index); //得到文件索引
                    // console.log(file); //得到文件对象
                    // console.log(result); //得到文件base64编码，比如图片
                    //obj.resetFile(index, file, '123.jpg'); //重命名文件名，layui 2.3.0 开始新增
                    //这里还可以做一些 append 文件列表 DOM 的操作
                    obj.upload(index, file); //对上传失败的单个文件重新上传，一般在某个事件中使用
                    //delete files[index]; //删除列表中对应的文件，一般在某个事件中使用
                    $('body').on('click','#upload-list i',function(){
                        var self = $(this),
                            li = self.parents('li')
                        var i = li.index()
                        console.log(i);
                        li.remove()
                        delete files[i];
                    })
                });
                console.log(files);
            },done: function(){
                
            }

        });      
        
        html = $('#tpl-mobile-qrcode').html()

        form.on('submit(formSubmit)', function(data){
            // layer.alert(JSON.stringify(data.field), {
            //     title: '最终的提交信息'
            // })
            // 弹出提示
            // layer.msg('弹出提示',{icon:1})

            // 弹出页面层
            // layer.open({
            //     type: 1
            //     , title: '手机预订'
            //     , area: ['400px', '300px']
            //     , shade: .3
            //     , btnAlign: 'c'
            //     , content: html
            //     // , btn: ["提交", '关闭'] //只是为了演示
            //     , success: function(){
                    
            //     }
            //     , yes: function (index, layero) {
            //     }
            // });

            //弹出确认框
            layer.confirm('您是如何看待前端开发？', {
                icon: 0, //提示icon：{0:'惊',1:'对',2:'错',3:'问',4:'锁',5:'哭',6:'笑'}
                btn: ['确定','取消'], //按钮
                btnAlign: 'c', //操作按钮居中
                shade: [0.3, '#000'] //不显示遮罩
            }, function(){ 
            //确定的内容
            }, function(){
            //取消的内容
            });

        });



    })

</script>
</body>
</html>